{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import{auth}from\"./firebase\";import{deleteUser}from\"firebase/auth\";import{useNavigate,useLocation}from\"react-router-dom\";import\"./styles.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Profile(){var _location$state,_location$state2;const navigate=useNavigate();const location=useLocation();const[user,setUser]=useState(null);const[showConfirm,setShowConfirm]=useState(false);// üîë Detect admin viewing a student\nconst isAdminView=((_location$state=location.state)===null||_location$state===void 0?void 0:_location$state.viewUser)===true;const viewedUser=(_location$state2=location.state)===null||_location$state2===void 0?void 0:_location$state2.user;useEffect(()=>{// ADMIN viewing STUDENT\nif(isAdminView&&viewedUser){setUser({name:viewedUser.name,email:viewedUser.email||\"student@example.com\",role:\"student\"});return;}// NORMAL logged-in user (admin or student)\nconst currentUser=auth.currentUser;if(!currentUser){navigate(\"/login\");return;}setUser({name:currentUser.displayName||\"User\",email:currentUser.email,role:localStorage.getItem(\"userRole\")});},[navigate,isAdminView,viewedUser]);// ‚ùå Admin must NOT delete student accounts from here\nconst handleDeleteAccount=async()=>{if(isAdminView)return;try{const currentUser=auth.currentUser;if(currentUser){await deleteUser(currentUser);localStorage.clear();navigate(\"/\",{replace:true});}}catch(error){alert(\"Please re-login to delete account.\");}};if(!user)return null;return/*#__PURE__*/_jsxs(\"div\",{className:\"profile-page\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"profile-card\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Profile\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"Full Name:\"}),/*#__PURE__*/_jsx(\"span\",{children:user.name})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"Email:\"}),/*#__PURE__*/_jsx(\"span\",{children:user.email})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"Role:\"}),/*#__PURE__*/_jsx(\"span\",{children:user.role})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile-buttons\",children:[!isAdminView&&/*#__PURE__*/_jsx(\"button\",{className:\"delete-btn\",onClick:()=>setShowConfirm(true),children:\"Delete Account\"}),/*#__PURE__*/_jsx(\"button\",{className:\"back-btn\",onClick:()=>isAdminView?navigate(\"/admin\"):navigate(-1),children:\"Back\"})]})]}),showConfirm&&/*#__PURE__*/_jsx(\"div\",{className:\"confirm-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"confirm-box\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"Are you sure you want to delete your account?\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"confirm-actions\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"confirm-delete\",onClick:handleDeleteAccount,children:\"Delete\"}),/*#__PURE__*/_jsx(\"button\",{className:\"confirm-cancel\",onClick:()=>setShowConfirm(false),children:\"Cancel\"})]})]})})]});}export default Profile;","map":{"version":3,"names":["React","useEffect","useState","auth","deleteUser","useNavigate","useLocation","jsx","_jsx","jsxs","_jsxs","Profile","_location$state","_location$state2","navigate","location","user","setUser","showConfirm","setShowConfirm","isAdminView","state","viewUser","viewedUser","name","email","role","currentUser","displayName","localStorage","getItem","handleDeleteAccount","clear","replace","error","alert","className","children","onClick"],"sources":["D:/siddhartha/Downloads/One-Stop-Personalized-Career-Education-Advisor/One-Stop-Personalized-Career-Education-Advisor/src/Profile.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { auth } from \"./firebase\";\r\nimport { deleteUser } from \"firebase/auth\";\r\nimport { useNavigate, useLocation } from \"react-router-dom\";\r\nimport \"./styles.css\";\r\n\r\nfunction Profile() {\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n\r\n  const [user, setUser] = useState(null);\r\n  const [showConfirm, setShowConfirm] = useState(false);\r\n\r\n  // üîë Detect admin viewing a student\r\n  const isAdminView = location.state?.viewUser === true;\r\n  const viewedUser = location.state?.user;\r\n\r\n  useEffect(() => {\r\n    // ADMIN viewing STUDENT\r\n    if (isAdminView && viewedUser) {\r\n      setUser({\r\n        name: viewedUser.name,\r\n        email: viewedUser.email || \"student@example.com\",\r\n        role: \"student\",\r\n      });\r\n      return;\r\n    }\r\n\r\n    // NORMAL logged-in user (admin or student)\r\n    const currentUser = auth.currentUser;\r\n\r\n    if (!currentUser) {\r\n      navigate(\"/login\");\r\n      return;\r\n    }\r\n\r\n    setUser({\r\n      name: currentUser.displayName || \"User\",\r\n      email: currentUser.email,\r\n      role: localStorage.getItem(\"userRole\"),\r\n    });\r\n  }, [navigate, isAdminView, viewedUser]);\r\n\r\n  // ‚ùå Admin must NOT delete student accounts from here\r\n  const handleDeleteAccount = async () => {\r\n    if (isAdminView) return;\r\n\r\n    try {\r\n      const currentUser = auth.currentUser;\r\n\r\n      if (currentUser) {\r\n        await deleteUser(currentUser);\r\n        localStorage.clear();\r\n        navigate(\"/\", { replace: true });\r\n      }\r\n    } catch (error) {\r\n      alert(\"Please re-login to delete account.\");\r\n    }\r\n  };\r\n\r\n  if (!user) return null;\r\n\r\n  return (\r\n    <div className=\"profile-page\">\r\n      <div className=\"profile-card\">\r\n        <h2>Profile</h2>\r\n\r\n        <div className=\"profile-row\">\r\n          <span className=\"label\">Full Name:</span>\r\n          <span>{user.name}</span>\r\n        </div>\r\n\r\n        <div className=\"profile-row\">\r\n          <span className=\"label\">Email:</span>\r\n          <span>{user.email}</span>\r\n        </div>\r\n\r\n        <div className=\"profile-row\">\r\n          <span className=\"label\">Role:</span>\r\n          <span>{user.role}</span>\r\n        </div>\r\n\r\n        <div className=\"profile-buttons\">\r\n          {/* ‚ùå Hide delete button when admin views student */}\r\n          {!isAdminView && (\r\n            <button\r\n              className=\"delete-btn\"\r\n              onClick={() => setShowConfirm(true)}\r\n            >\r\n              Delete Account\r\n            </button>\r\n          )}\r\n\r\n          <button\r\n            className=\"back-btn\"\r\n            onClick={() =>\r\n              isAdminView ? navigate(\"/admin\") : navigate(-1)\r\n            }\r\n          >\r\n            Back\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* CONFIRMATION POPUP */}\r\n      {showConfirm && (\r\n        <div className=\"confirm-overlay\">\r\n          <div className=\"confirm-box\">\r\n            <p>Are you sure you want to delete your account?</p>\r\n\r\n            <div className=\"confirm-actions\">\r\n              <button\r\n                className=\"confirm-delete\"\r\n                onClick={handleDeleteAccount}\r\n              >\r\n                Delete\r\n              </button>\r\n              <button\r\n                className=\"confirm-cancel\"\r\n                onClick={() => setShowConfirm(false)}\r\n              >\r\n                Cancel\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Profile;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}